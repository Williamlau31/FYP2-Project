<ion-header class="custom-header">
  <ion-toolbar class="custom-toolbar">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home" class="back-button"></ion-back-button>
    </ion-buttons>
    <ion-title class="page-title">
      <div class="title-content">
        <ion-icon name="calendar" class="title-icon"></ion-icon>
        <span>Appointments</span>
      </div>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button fill="clear" (click)="openAddModal()" class="add-button">
        <ion-icon name="add" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="appointments-content">
  <!-- Header Stats -->
  <div class="page-header">
    <div class="header-stats">
      <div class="stat-item">
        <div class="stat-icon scheduled">
          <ion-icon name="calendar-outline"></ion-icon>
        </div>
        <div class="stat-info">
          <h3>12</h3>
          <p>Scheduled</p>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon completed">
          <ion-icon name="checkmark-circle"></ion-icon>
        </div>
        <div class="stat-info">
          <h3>8</h3>
          <p>Completed</p>
        </div>
      </div>
      <div class="stat-item">
        <div class="stat-icon cancelled">
          <ion-icon name="close-circle"></ion-icon>
        </div>
        <div class="stat-info">
          <h3>2</h3>
          <p>Cancelled</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="filter-section">
    <div class="filter-chips">
      <ion-chip class="filter-chip active">
        <ion-icon name="calendar"></ion-icon>
        <ion-label>All</ion-label>
      </ion-chip>
      <ion-chip class="filter-chip">
        <ion-icon name="today"></ion-icon>
        <ion-label>Today</ion-label>
      </ion-chip>
      <ion-chip class="filter-chip">
        <ion-icon name="calendar-outline"></ion-icon>
        <ion-label>This Week</ion-label>
      </ion-chip>
      <ion-chip class="filter-chip">
        <ion-icon name="time"></ion-icon>
        <ion-label>Upcoming</ion-label>
      </ion-chip>
    </div>
  </div>

  <!-- Appointments List -->
  <div class="appointments-list">
    @if (appointments.length > 0) {
      @for (appointment of appointments; track appointment.id) {
        <div class="appointment-card">
          <div class="appointment-main">
            <div class="appointment-time">
              <div class="time-display">
                <span class="time">{{ appointment.time }}</span>
                <span class="date">{{ appointment.date | date:'MMM dd' }}</span>
              </div>
              <div class="status-indicator">
                <ion-chip [color]="getStatusColor(appointment.status)" class="status-chip">
                  <ion-icon [name]="getStatusIcon(appointment.status)"></ion-icon>
                  <ion-label>{{ appointment.status | titlecase }}</ion-label>
                </ion-chip>
              </div>
            </div>
            
            <div class="appointment-details">
              <div class="patient-info">
                <h3 class="patient-name">
                  <ion-icon name="person" class="patient-icon"></ion-icon>
                  {{ appointment.patient_name }}
                </h3>
                <p class="staff-info">
                  <ion-icon name="medical" class="staff-icon"></ion-icon>
                  Dr. {{ appointment.staff_name }}
                </p>
              </div>
              
              @if (appointment.notes) {
                <div class="appointment-notes">
                  <ion-icon name="document-text" class="notes-icon"></ion-icon>
                  <p>{{ appointment.notes }}</p>
                </div>
              }
            </div>
          </div>
          
          <div class="appointment-actions">
            <ion-button fill="clear" size="small" (click)="editAppointment(appointment)" class="action-button edit">
              <ion-icon name="create" slot="icon-only"></ion-icon>
            </ion-button>
            <ion-button fill="clear" size="small" (click)="deleteAppointment(appointment.id!)" class="action-button delete">
              <ion-icon name="trash" slot="icon-only"></ion-icon>
            </ion-button>
          </div>
        </div>
      }
    } @else {
      <div class="empty-state">
        <div class="empty-icon">
          <ion-icon name="calendar-outline"></ion-icon>
        </div>
        <h3>No Appointments Found</h3>
        <p>Start by scheduling your first appointment</p>
        <ion-button (click)="openAddModal()" expand="block" class="empty-action-button">
          <ion-icon name="add" slot="start"></ion-icon>
          Schedule Appointment
        </ion-button>
      </div>
    }
  </div>

  <!-- Floating Action Button -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="openAddModal()" class="fab-button">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
